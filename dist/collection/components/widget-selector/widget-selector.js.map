{"version":3,"file":"widget-selector.js","sourceRoot":"","sources":["../../../src/components/widget-selector/widget-selector.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,eAAe,CAAC;AACvE,OAAO,EAAE,kBAAkB,EAAE,MAAM,wBAAwB,CAAC;AAE5D,OAAO,EAAE,KAAK,EAAE,MAAM,kBAAkB,CAAC;AACzC,OAAO,EAAE,WAAW,EAAE,MAAM,iBAAiB,CAAC;AAC9C,OAAO,IAAI,MAAM,iBAAiB,CAAC;AAMnC,MAAM,OAAO,cAAc;;;wBAEE,IAAI;;uBAGZ,KAAK;;+BAEW,IAAI;;IAEvC,KAAK,CAAC,gBAAgB;QACpB,+FAA+F;QAC/F,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACpB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAClB,IAAI,CAAC;YACH,IAAI,CAAC,IAAI,GAAG,MAAM,kBAAkB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAC/C,KAAK,CAAC,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC;QAClC,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,OAAO,CAAC,KAAK,CAAC,iCAAiC,EAAE,KAAK,CAAC,CAAC;YACxD,IAAI,CAAC,KAAK,GAAG,KAAK,YAAY,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,2BAA2B,CAAC;YAClF,KAAK,CAAC,aAAa,GAAG,IAAI,CAAC;QAC7B,CAAC;gBAAS,CAAC;YACT,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACvB,CAAC;IACH,CAAC;IAED,iBAAiB;QACf,IAAI,IAAI,CAAC,GAAG,EAAE,CAAC;YACb,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACxB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QACpB,CAAC;aAAM,CAAC;YACN,IAAI,CAAC,KAAK,GAAG,mBAAmB,CAAC;QACnC,CAAC;QACD,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;YAClB,WAAW,CAAC,IAAI,CAAC,QAA8B,CAAC,CAAC,CAAC,yCAAyC;QAC7F,CAAC;IACH,CAAC;IAGD,WAAW,CAAC,OAAe;QACzB,MAAM,kBAAkB,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QACxC,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC;YAC1C,OAAO,GAAG,IAAI,CAAC,CAAC,WAAW;QAC7B,CAAC;QAED,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;QAC7B,IAAI,CAAC,eAAe,GAAG,OAAO,CAAC;IACjC,CAAC;IAEO,YAAY;;QAClB,IAAI,MAAA,IAAI,CAAC,IAAI,0CAAE,IAAI,EAAE,CAAC;YACpB,QAAQ,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;gBACvB,KAAK,IAAI;oBACP,OAAO,sBAAe,CAAC;gBACzB,KAAK,IAAI;oBACP,OAAO,wBAAiB,CAAC;gBAC3B,KAAK,IAAI;oBACP,OAAO,sBAAgB,GAAG,EAAE,IAAI,CAAC,GAAG,GAAI,CAAC;gBAC3C;oBACE,OAAO,IAAI,CAAC,CAAC,sBAAsB;YACvC,CAAC;QACH,CAAC;IACH,CAAC;IAED,MAAM;QACJ,OAAO,CACL,EAAC,IAAI,uDACF,IAAI,CAAC,YAAY,EAAE,CACf,CACR,CAAC;IACJ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CACF","sourcesContent":["import { Component, h, Host, Prop, State, Watch } from '@stencil/core';\r\nimport { fetchWidgetDetails } from '@src/services/services';\r\nimport { IWidgetDetails, SupportedLanguages } from '@src/interfaces/interfaces';\r\nimport { state } from '@src/store/store';\r\nimport { setLanguage } from '@src/utils/i18n';\r\nimport i18n from '@src/utils/i18n';\r\n@Component({\r\n  tag: 'tt-widget',\r\n  styleUrl: './widget-selector.css',\r\n  shadow: false,\r\n})\r\nexport class WidgetSelector {\r\n  @Prop({ reflect: true, mutable: true }) wId: string;\r\n  @Prop() language: string = 'en'; // Default to English\r\n\r\n  @State() error: string;\r\n  @State() loading = false;\r\n  @State() data: IWidgetDetails;\r\n  @State() currentLanguage: string = 'en';\r\n\r\n  async getWidgetDetails() {\r\n    // fetch widget details from the server and set the widget properties in the store state object\r\n    this.loading = true;\r\n    this.error = null;\r\n    try {\r\n      this.data = await fetchWidgetDetails(this.wId);\r\n      state.widgetDetails = this.data;\r\n    } catch (error) {\r\n      console.error('Failed to fetch widget details:', error);\r\n      this.error = error instanceof Error ? error.message : 'An unknown error occurred';\r\n      state.widgetDetails = null;\r\n    } finally {\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  componentWillLoad() {\r\n    if (this.wId) {\r\n      this.getWidgetDetails();\r\n      this.error = null;\r\n    } else {\r\n      this.error = 'Widget ID missing';\r\n    }\r\n    if (this.language) {\r\n      setLanguage(this.language as SupportedLanguages); // Store the language in the global store\r\n    }\r\n  }\r\n\r\n  @Watch('lang') // Watch for language changes\r\n  setLanguage(newLang: string) {\r\n    const supportedLanguages = ['en', 'fr'];\r\n    if (!supportedLanguages.includes(newLang)) {\r\n      newLang = 'en'; // Fallback\r\n    }\r\n\r\n    i18n.changeLanguage(newLang);\r\n    this.currentLanguage = newLang;\r\n  }\r\n\r\n  private renderWidget() {\r\n    if (this.data?.type) {\r\n      switch (this.data.type) {\r\n        case 'WG':\r\n          return <full-widget />;\r\n        case 'BT':\r\n          return <button-widget />;\r\n        case 'QR':\r\n          return <qr-code-widget wId={this.wId} />;\r\n        default:\r\n          return null; // handle unknown type\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        {this.renderWidget()}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}