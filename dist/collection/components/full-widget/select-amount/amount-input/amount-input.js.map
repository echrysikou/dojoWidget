{"version":3,"file":"amount-input.js","sourceRoot":"","sources":["../../../../../src/components/full-widget/select-amount/amount-input/amount-input.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Element, h, Prop, State, Watch } from '@stencil/core';\r\nimport i18n from '@src/utils/i18n';\r\nimport { onChange, state } from '@src/store/store';\r\nimport { getSafeDangerColor } from '@src/utils/utils';\r\n\r\n@Component({\r\n  tag: 'amount-input',\r\n  styleUrl: 'amount-input.css',\r\n  shadow: false,\r\n})\r\nexport class AmountInput {\r\n  @Element() el: HTMLElement;\r\n  private inputRef: HTMLInputElement;\r\n\r\n  @Prop() maxDecimals: number = 2;\r\n\r\n  @State() selectedAmount: string = '';\r\n  @State() isHovered: boolean = false;\r\n  @State() amountTooLow: boolean = false; // Stripe allows amounts greater than 1Euro\r\n\r\n  @Watch('selectedAmount')\r\n  watchAmount(newValue: string) {\r\n    const amount = newValue ? parseFloat(newValue) : 0;\r\n    state.stripe = { paymentElementIntentAmount: amount * 100, amountIsValid: amount >= 1 };\r\n    this.amountTooLow = amount < 1;\r\n  }\r\n\r\n  componentWillLoad() {\r\n    this.selectedAmount = '';\r\n  }\r\n\r\n  // Validate input is a number with max two decimals\r\n  isValidNumber(value: string): boolean {\r\n    const regex = new RegExp(`^\\\\d*(\\\\.\\\\d{0,${this.maxDecimals}})?$`);\r\n    return regex.test(value);\r\n  }\r\n\r\n  handleInput(event: Event) {\r\n    const input = event.target as HTMLInputElement;\r\n    const inputValue = input.value;\r\n\r\n    if (this.isValidNumber(inputValue)) {\r\n      this.selectedAmount = inputValue;\r\n    } else {\r\n      // If invalid, revert to the last valid value\r\n      input.value = this.selectedAmount;\r\n    }\r\n  }\r\n\r\n  // handle external state changes\r\n  handleStateChange = () => {\r\n    this.selectedAmount = (state.stripe.paymentElementIntentAmount / 100).toString();\r\n    if (this.inputRef) {\r\n      this.inputRef.value = this.selectedAmount; // Update the input's value directly\r\n    }\r\n  };\r\n\r\n  componentDidLoad() {\r\n    onChange('stripe', this.handleStateChange);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    onChange('stripe', this.handleStateChange); // Remove the listener\r\n  }\r\n\r\n  render() {\r\n    const { font, themeColor: bgColor, borderColor: secondaryColor } = state.widgetDetails;\r\n\r\n    return (\r\n      <div class=\"enter-amount-container\">\r\n        <app-typography\r\n          variant=\"secondaryCaption\"\r\n          fontFamily={font.includes('Baloo Bhaijaan 2') ? 'Raleway, sans-serif' : font}\r\n          styleProps={{\r\n            fontWeight: '500',\r\n          }}\r\n        >\r\n          {i18n.t('enterAmount')}\r\n        </app-typography>\r\n\r\n        <div class=\"form-control\" onMouseOver={() => (this.isHovered = true)} onMouseOut={() => (this.isHovered = false)} style={{ height: '56px' }}>\r\n          <div class=\"input-container\" style={{ border: `${this.isHovered ? '2px' : '0.5px'} solid ${secondaryColor}`, height: '56px' }}>\r\n            <span class=\"input-adornment\" style={{ fontFamily: font }}>\r\n              â‚¬\r\n            </span>\r\n\r\n            <input\r\n              id={`outlined-adornment-amount${this.selectedAmount}`}\r\n              ref={el => (this.inputRef = el)}\r\n              style={{ fontFamily: font }}\r\n              type=\"number\"\r\n              onInput={event => this.handleInput(event)}\r\n              step=\"0.01\"\r\n              min=\"1\"\r\n              value={this.selectedAmount}\r\n            />\r\n          </div>\r\n          {this.amountTooLow && (\r\n            <app-typography variant=\"secondaryMessage\" class=\"low-amount-error\" style={{ color: getSafeDangerColor(bgColor) }}>\r\n              {i18n.t('minStripeAmount')}\r\n            </app-typography>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]}